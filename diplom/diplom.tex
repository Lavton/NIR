\documentclass[a4paper,14pt]{extarticle} %размер бумаги устанавливаем А4, шрифт 12пунктов
\usepackage[T2A]{fontenc}
%\usepackage[utf8]{inputenc} 
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\inputencoding{utf8}
\usepackage[english,russian]{babel}%используем русский и английский языки с переносами
\usepackage{amssymb,amsfonts,amsmath,mathtext,cite,enumerate,float}%подключаем нужные пакеты расширений
\usepackage[pdftex]{graphicx} %хотим вставлять в диплом рисунки?
\usepackage{color}
\usepackage[ section ]{ placeins}
\usepackage[pdftex]{lscape}
\usepackage{lscape}
\usepackage{svg}
\setsvg{inkscape = inkscape -z -D}
\setsvg{svgpath = images/}
%\graphicspath{{noiseimages/}}%путь к рисункам
\usepackage{listings}
\lstset{language=Fortran}
\makeatletter
\renewcommand{\@biblabel}[1]{#1.} % Заменяем библиографию с квадратных скобок на точку:
\makeatother
\setcounter{tocdepth}{3}
\usepackage{geometry} % Меняем поля страницы
\makeatletter
\@addtoreset{equation}{subsection}
\makeatother

\newcommand{\frp}[2]{\frac{\partial #1}{\partial #2}}

\renewcommand*{\thesection}{\arabic{section}}

\geometry{left=2cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=1cm}% верхнее поле
\geometry{bottom=2cm}% нижнее поле


\makeatletter
%\renewcommand{\@biblabel}[1]{#1.} % Заменяем библиографию с квадратных скобок на точку:
\makeatother

\usepackage{geometry} % Меняем поля страницы
\geometry{left=3cm}% левое поле
\geometry{right=1cm}% правое поле
\geometry{top=2cm}% верхнее поле
\geometry{bottom=2cm}% нижнее поле
\renewcommand*{\thesection}{\arabic{section}}

\abovedisplayskip=1.5\abovedisplayskip %отбивки вокруг формул

\renewcommand{\baselinestretch}{1.5}

\renewcommand{\theenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumii}{.\arabic{enumii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumiii}{.\arabic{enumiii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.}% Меняем везде перечисления на цифра.цифра

\begin{document}
\begin{titlepage}

\begin{center}
Федеральное государственное автономное образовательное\\
учреждение высшего образования\\
<<Санкт-Петербургский Политехнический университет Петра Великого>>\\
Институт физики, нанотехнологий и телекоммуникаций\\
Кафедра космических исследований \\
\end{center}  

\vspace{1em}

\begin{flushright}
\parindent=0pt
\makebox[15em][l]{Работа допущена к защите}\\
\makebox[15em][l]{Заведующий кафедрой КИ}\\
\makebox[15em][l]{\hrulefill Варшалович Д.А.}\\
\makebox[15em][l]{<<\hrulefill >>\hrulefill 2015 г.\phantom{mmmm}}
\end{flushright}

\vspace{1em}

\begin{center}
ВЫПУСКНАЯ РАБОТА БАКАЛАВРА\\
\Large\textbf{<<Численное моделирование ускорения частиц\\ на ударных волнах>>}
\end{center}

\vspace{1em}

\begin{flushleft}
\begin{tabbing}
aaaaaaaaaaaaaaaaa \= aaaaaaaaaaaaaaaaaaaaaaa \kill
Направление: \> 03.03.02 -- <<Физика>>\\
Профиль: \> <<Физика космоса>>\\
\end{tabbing}
\end{flushleft}

\vspace{1em}

\begin{tabbing}
  \hspace{17cm}\=\kill
  Студент гр.43412\>\textbf{Лиознов А.В.}\'\\~\\
  Руководитель\> \'\\
  ст.н.с. ФТИ им.\\
А.Ф.Иоффе, к.ф.-м.н.\>\textbf{Гладилин П.Е.}\'\\
\end{tabbing}

\vspace{\fill}

\begin{center}
Санкт-Петербург\\
2015
\end{center}

\end{titlepage}
\newpage
\tableofcontents
\newpage
\section{Введение}
\subsection{Актуальность}
В течение продолжительного времени учёные пытаются определить, как образуется наблюдаемое распределение космических лучей по энергиям. Далеко не весь диапазон спектра можно описать с помощью теплового взаимодействия.

Особую роль играют механизмы нетеплового ускорения частиц в бесстолкновительной космической плазмы. 

Такие частицы можно непосредственно наблюдать в межпланетном пространстве, частицы низких энергий - непосредственно наблюдать с Земли, а частицы высоких энергий ($>10^5$ ГэВ) - в виде широких атмосферных ливней.

Особый интерес составляет процесс ускорения на фронтах ударных волн, в силу их распространённости.
Примерами таких волн могут служить волны от хромосферных солнечных вспышек, вспышек сверхновых звёзд...

Дополнительный интерес к данным процессам связан с возможностью выделения в них большого количества энергии, существенная часть которой может быть преобразована в направленное ускорение небольшого количества частиц, что и приводит к появлению частиц с энергиями, на много порядков превышающих тепловые.

Понимание данных процессов необходимы для построения моделей ударных волн.

Проблемой занимаются давно.\\
 Бережко Е. Г. и Крымский Г. Ф. в 1988 году привели теоретический вывод диффузиозно-конвективного уравнения. Х. Канг в 2011 году провёл численные расчёты для этого вида. \\ 
С другой стороны к задаче подошёли А. Ахтенберг и В. Круллс, которые в 1992 году провёли рассмотрение ускорения стохастическим подходом. 

И, хотя сравнения данных подходов предпринимались, количественные оценки как с точки зрения времени работы, так и с точки зрения простоты реализации и расширяемости сделаны не были.

\subsection{Цели и задачи}
В связи со всем вышесказанным целью работы был анализ и сравнение \\
диффузиозно-конвективного и стохастического подхода в ускорении частиц на ударных волнах.

В рамках этой цели были поставлены следующие задачи:
\begin{enumerate}
\item Реализовать численное моделирование решения диффузиозно- конвективного уравнения методом Эйлера в ускорении частиц на ударных волнах.
\item Реализовать численное моделирование стохастического процесса в ускорении частиц на ударных волнах.
\item Провести сравнение данных подходов
\item Указать положительные и отрицательные стороны в каждом из них
\end{enumerate}

\subsection{Процес ускорения на ударных волнах}
Рассмотрим физическую сторону процесса ускорения на ударных волнах:

Движение частиц плазмы определяется не соударениями, как в случае теплового движения, а возникающий на фронте турбулентностью.

Несмотря на то, что сама теория ударных волн ещё далека от завершения, характер достаточно быстрых частиц на фронте мало зависит от особенностей структуры. Это связано с тем, что движение частиц зависит, в основном, от двух факторов: взаимодействии с магнитным полем - крупномасштабным, регулярным, с одной стороны, и турбулентным, хаотичным - с другой. Это поле приводит к рассеянию частиц, причём пробег до рассеяния сильно превышает толщину фронта.

Возможность ускорения частиц связана, прежде всего, с имеющимися в пространстве электрическими полями. Для иллюстрации на рисунке \ref{intro/lam}а схематически изображена траектория частицы в системе покоя фронта в случае, когда мелкомасштабные электрические поля отсутствуют. Для быстрой частицы ударная волна представляет собой магнитогидродинамический разрыв, в котором скорость плазмы $u$, плотность $\rho$, магнитное поле $B$ связано следующими соотношениями:
\begin{eqnarray}
\rho_2 = \sigma \rho_1\\
u_2=\frac{u_1}{\sigma}\\
B_2=\sigma B_1
\end{eqnarray}
Где индексы 1, 2 означают область до и после фронта соответственно, а $\sigma$ - степень сжатия вещества.

Пересекая фронт, частица испытывает градиентный дрейф и смещается вдоль электрического поля
$\vec{E} = - [\vec{u}\vec{B}]/c$, где $c$ - скорость света.

\begin{figure}[htbp]
  \centering
  \includesvg[width=400px]{lamin}
  \caption{\label{intro/lam} Движение быстро заряженной частицы в ламинарной ударной волне (а) и турбулетной(б)}
\end{figure}
Каждая частица рассеивается на неоднородностях магнитного поля (рис \ref{intro/lam}б), что приводит к многократному перемещению между областями фронтов и многократному ускорению. За один цикл (двукратное пересечение фронта) среднее изменение импульса частицы будет равно
\begin{equation}
\left< \Delta p \right> = \frac{4}{3} (u_2-u_1)\frac{p}{v}
\end{equation}
Где $u_2$, $u_1$ - скорость плазмы за и перед фронтом, $v$ - скорость частицы.

В каждом цикле часть частиц уходит и уже не возвращается к фронту. Интегральный спектр ускорения частиц $N(p)$ - количество частиц в единице объёма с импульсами, большими $p$,  - может быть найден из уравнения баланса
\begin{equation}
\frac{dN}{dp}=\frac{P_c-1}{\left<\Delta p \right>}N
\end{equation}
Где $P_c$ - вероятность совершения очередного цикла. $P_c=P_1 \cdot P_2$, где $P_1$ - вероятность частицы попавшей в область перед фронтом, вернуться на фронт и равна 1, а $P_2$ - аналогичная вероятность для области за фронтом и равна $1-\frac{4u_2}{v}$

Используя последние уравнения, можно получить уравнение на плотность:
\begin{equation}
\frac{d pn}{dp} + 3 \frac{u_2}{u_1-u_2} n = 0
\end{equation}
\subsection{Методы исследования}
Для решения диффузиозно-конвективного уравнения была разработана программа на языке C++, организующая численное моделирование методом прогонки.

Стохастическое уравнение решалось в виде уравнения Ито и реализацией алгоритма так же на языке C++.

Остановимся подробнее на каждом из них
\subsubsection{Моделирование диффузиозно-конвективного уравнения с помощью неявного метода Эйлера}
Изначальное уравнение имеет вид
\begin{equation}
\frac{\partial f}{\partial t} = \frac{\partial}{\partial x} \kappa \frac{\partial f}{\partial x} - u \frac{\partial f}{\partial x} - \frac{\Delta u}{3} \delta(x) p \frac{\partial f}{\partial p} +Q
\end{equation}
Где $f$ - функция распределения частиц, $\kappa$ - коэффициент диффузии, $Q$ - мощность источника частиц.

Решим данное уравнение с помощью неявного метода Эйлера.

Для этого надо подставить вместо производных конечные разности и получить следующий общий вид:
\begin{multline}
\frac{f_{i,j,k} - f_{i,j,k-1}}{\Delta t} = \kappa_{j} \frac{f_{i+1,j,k}+f_{i-1,j,k}-2f_{i,j,k}}{\Delta^2 x} \\
- u_i\frac{f_{i,j,k}-f_{i-1,j,k}}{\Delta x}-\frac{u_i-u_{i-1}}{3\Delta x}\frac{f_{i,j,k}-f_{i,j-1,k}}{\Delta y} + Q
\end{multline}
Где индексы $i, j, k$ отвечают за координату, импульс и время соответственно, а $y$ есть логарифм от импульса.
Далее система записывается в виде матричного уравнения
\begin{equation}
Mx=F
\end{equation}
где $M$ - трёхдиаганальная матрица с $A_i$ на поддиаганали, $C_i$ - на главной диаганали и $B_i$ на наддиаганали. В приложении задачи коэффициенты получились следующими:
\begin{eqnarray}
A_i&=\frac{\Delta t \kappa_{i,j}}{\Delta^2 x} + \frac{u_i\Delta t}{\Delta x}\\
C_i&=\frac{2\Delta t \kappa_{i,j}}{\Delta x^2} + \frac{\Delta t u_i}{\Delta x} + \frac{u_i-u_{i-1}\Delta t}{3\Delta x \Delta y} - 1\\
B_i&=\frac{\Delta t \kappa_{i,J}}{\Delta^2 x}\\
F_i&=-f_{i,j,k-1}-\frac{f_{i,j-1,k}}{\Delta y} \frac{u_i-u{i-1}\Delta t}{3\Delta x} - Q\Delta t
\end{eqnarray} 
Далее данное уравнение решается методом прогонки.
\subsubsection{Моделирование стохастического процесса}
В данном случае уравнение принимает вид
\begin{equation}
\frac{\partial F(\vec{Z}, t)}{\partial t} = \frac{\partial}{\partial \vec{Z}}\left( -\dot{\vec{Z}}F+\frac{\partial}{\partial\vec{Z}}[DF]  \right)
\end{equation}
Где $Z\equiv (x, p)$.
\begin{equation}
\dot{\vec{Z}} = \left< \frac{d\vec{Z}}{dt} \right> + \frac{\partial}{\partial\vec{Z}} D
\end{equation}
Это уравнение может быть представлено в форме уравнения Ито:
\begin{equation}
d\vec{Z} = d\dot{\vec{Z}}(\vec{Z}, t)+\sqrt{2D}dW
\end{equation}
Где $dW$ - Винеровский процесс
В приложении к конкретной задачи для заряженных частиц имеем
\begin{eqnarray}
dx = V(x)dt+\sqrt{2K_{\parallel}}dW\\
du = - \frac{1}{3} \frac{\partial V}{\partial x} dt
\end{eqnarray}
Здесь $V(x)$ - скорость плазмы, $K_\parallel$ - коэффициент диффузии, $u$ - логарифм импульса.\\
Как известно, общий вид уравнения Ито выглядит как
\begin{equation}
dx = a(x, t)dt + b(x,t) \underbrace{\varepsilon \sqrt{dt}}_{dW}
\end{equation}
где $a$ имеет физический смысл сноса частицы, а $b$ - отклонения. $\varepsilon$ - нормально распределённая случайная величина.

Задав обе функции, а так же размер и количество шагов по времени, мы получаем предсказание координаты и импульса для одной частицы.

Запустив код для $N$ частиц, можно получить массивы координат и импульсов для конца времени. Далее строя гистограмму распределения для импульса мы получаем империческую функцию распределения $f_p$, которая может быть сравнима с аналогичной функцией, полученной в другом подходе.

Как было написано выше, $a(x,t) \equiv V(x)$, где $V(x)$ - скорость для ударной волны. Стандартная степень сжатия на фронте равна 4, т.е. $V|_{x \ll x_{inj}} = 4V|_{x \gg x_{inj}}$
Для устойчивости работы программы должно выполняться условие
\begin{equation}
V\Delta t \le \Delta x_s \ll \sqrt{K_\parallel \Delta t}
\end{equation}
Где $\Delta x_s$ - характерное масштаб фронта. ~\\~\\
В качестве демонстрации преимуществ данного подхода были реализовано ещё два физических процесса: ускорение электронов с учётом синхротронных потерь и ускорение на сходящихся фронтах.\\
Синхротронные потери можно ввести, заменив уравнение для логарифма импульса на 
\begin{equation}
du = - \left( \frac{1}{3} \frac{\partial V}{\partial x}  + \beta_s\sqrt{1+e^{2u}} \right) dt
\end{equation}
Для они существенны лишь для электронов в силу малой массы.


Ускорение на сходящихся фронтах соответствует занулению скорости вдали от фронта и увеличению числа частиц в двое. Физический смысл у данной операции следующий:
Представим две сходящиеся волны. Для быстрых частиц расстояние между фронтами много меньше длины свободного пробега. А значит для них как бы существует лишь пространство перед фронтом, а за фронтом скорость равна нулю. Соответственно, поскольку мы рассматриваем ударные волны симметричными, допустимо свести их к одной, увеличив количество частиц вдвое.
\bibliographystyle{gost71s}
\bibliography{Biblio}

\end{document}
